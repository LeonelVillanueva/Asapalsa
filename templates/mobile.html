<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="Sistema de análisis de datos agroindustriales - Versión Móvil">
    <meta name="keywords" content="analytics, datos, agroindustria, móvil, mobile">
    <meta name="author" content="Leonel Villanueva y Arnold Suate">
    <title>ASAPALSA Analytics - Móvil</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='images/favicon-16x16.png') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='images/favicon-32x32.png') }}">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='images/asapalsa.png') }}">
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    
    <!-- CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/mobile.css') }}" rel="stylesheet">
</head>
<body>
    <!-- Skip to main content link -->
    <a href="#main-content" class="sr-only sr-only-focusable btn btn-primary position-absolute" style="top: 10px; left: 10px; z-index: 9999;">
        Saltar al contenido principal
    </a>
    
    <!-- Mobile Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top mobile-navbar" role="navigation" aria-label="Navegación móvil">
        <div class="container-fluid">
            <div class="d-flex align-items-center w-100">
                <!-- Logo y título compactos -->
                <a class="navbar-brand mobile-brand" href="#" aria-label="ASAPALSA Analytics">
                    <img src="{{ url_for('static', filename='images/asapalsa.png') }}" alt="ASAPALSA Logo" class="mobile-logo">
                    <div class="mobile-brand-text">
                        <div class="mobile-brand-title">ASAPALSA Analytics</div>
                        <div class="mobile-brand-subtitle">Análisis Agroindustrial</div>
                    </div>
                </a>
                
                <!-- Botón de historial -->
                <button class="btn btn-link mobile-nav-btn me-2" onclick="goToHistorial()" title="Ver Historial">
                    <i class="fas fa-history"></i>
                </button>
                
                <!-- Menú hamburguesa -->
                <button class="navbar-toggler mobile-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mobileNavbar" 
                        aria-controls="mobileNavbar" aria-expanded="false" aria-label="Menú">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            
            <!-- Menú colapsable -->
            <div class="collapse navbar-collapse" id="mobileNavbar">
                <ul class="navbar-nav mobile-nav">
                    <li class="nav-item">
                        <a class="nav-link mobile-nav-link" href="#upload-section">
                            <i class="fas fa-upload"></i>
                            <span>Cargar Datos</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mobile-nav-link" href="#chart-section">
                            <i class="fas fa-chart-bar"></i>
                            <span>Gráficos</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link mobile-nav-link" href="#summary-section">
                            <i class="fas fa-chart-pie"></i>
                            <span>Resumen</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="main-content" class="mobile-main">
        <!-- Hero Section Móvil -->
        <section class="mobile-hero">
            <div class="container-fluid">
                <div class="row justify-content-center">
                    <div class="col-12 text-center">
                        <h1 class="mobile-hero-title">Análisis de Decisiones Agroindustriales</h1>
                        <p class="mobile-hero-subtitle">Analiza la productividad de ASAPALSA con visualizaciones avanzadas para 
                            decisiones estratégicas</p>
                        <div class="mobile-hero-buttons">
                            <button class="btn btn-primary mobile-btn" onclick="scrollToSection('upload-section')">
                                <i class="fas fa-upload me-2"></i>
                                Comenzar Análisis
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Upload Section Móvil -->
        <section id="upload-section" class="mobile-section">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12">
                        <div class="mobile-card">
                            <h2 class="mobile-card-title">
                                <i class="fas fa-upload me-2"></i>
                                Cargar Archivo
                            </h2>
                            <p class="mobile-card-text">Selecciona un archivo CSV para comenzar el análisis</p>
                            
                            <div class="mobile-upload-area" id="mobileUploadArea">
                                <div class="mobile-upload-content">
                                    <i class="fas fa-cloud-upload-alt mobile-upload-icon"></i>
                                    <h3 class="mobile-upload-title">Arrastra tu archivo CSV aquí</h3>
                                    <p class="mobile-upload-text">o haz clic para seleccionar un archivo CSV</p>
                                    <input type="file" id="mobileFileInput" accept=".csv" class="d-none">
                                    <button class="btn btn-outline-primary mobile-upload-btn" onclick="document.getElementById('mobileFileInput').click()">
                                        Seleccionar Archivo
                                    </button>
                                </div>
                            </div>
                            
                            <div class="mobile-file-info d-none" id="mobileFileInfo">
                                <div class="mobile-file-details">
                                    <i class="fas fa-file-alt"></i>
                                    <div class="mobile-file-text">
                                        <div class="mobile-file-name" id="mobileFileName"></div>
                                        <div class="mobile-file-size" id="mobileFileSize"></div>
                                    </div>
                                    <button class="btn btn-sm btn-outline-danger" onclick="clearMobileFile()">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Chart Section Móvil -->
        <section id="chart-section" class="mobile-section">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12">
                        <div class="mobile-card">
                            <h2 class="mobile-card-title">
                                <i class="fas fa-chart-bar me-2"></i>
                                Tipo de Gráfico
                            </h2>
                            <p class="mobile-card-text">Selecciona el tipo de visualización que deseas generar</p>
                            
                            <div class="mobile-chart-buttons">
                                <button class="mobile-chart-btn" data-chart="line" onclick="selectMobileChart('line')">
                                    <i class="fas fa-chart-line"></i>
                                    <span>Línea</span>
                                </button>
                                <button class="mobile-chart-btn" data-chart="bar" onclick="selectMobileChart('bar')">
                                    <i class="fas fa-chart-bar"></i>
                                    <span>Barras</span>
                                </button>
                                <button class="mobile-chart-btn" data-chart="pie" onclick="selectMobileChart('pie')">
                                    <i class="fas fa-chart-pie"></i>
                                    <span>Circular</span>
                                </button>
                                <button class="mobile-chart-btn" data-chart="scatter" onclick="selectMobileChart('scatter')">
                                    <i class="fas fa-braille"></i>
                                    <span>Dispersión</span>
                                </button>
                                <button class="mobile-chart-btn" data-chart="histogram" onclick="selectMobileChart('histogram')">
                                    <i class="fas fa-chart-area"></i>
                                    <span>Histograma</span>
                                </button>
                            </div>
                            
                            <div class="mobile-chart-options d-none" id="mobileChartOptions">
                                <div class="mobile-form-group">
                                    <label class="mobile-form-label">Columna X:</label>
                                    <select class="mobile-form-select" id="mobileXColumn">
                                        <option value="">Seleccionar columna X</option>
                                    </select>
                                </div>
                                <div class="mobile-form-group">
                                    <label class="mobile-form-label">Columna Y:</label>
                                    <select class="mobile-form-select" id="mobileYColumn">
                                        <option value="">Seleccionar columna Y</option>
                                    </select>
                                </div>
                                <div class="mobile-form-group">
                                    <label class="mobile-form-label">Título del Gráfico:</label>
                                    <input type="text" class="mobile-form-input" id="mobileChartTitle" placeholder="Ingresa el título">
                                </div>
                                <button class="btn btn-primary mobile-btn" onclick="generateMobileChart()">
                                    <i class="fas fa-chart-line me-2"></i>
                                    Generar Gráfico
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Chart Display Móvil -->
        <section id="mobile-chart-display" class="mobile-section d-none">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12">
                        <div class="mobile-card">
        <div class="mobile-chart-header">
            <h3 class="mobile-chart-title" id="mobileChartDisplayTitle">Gráfico Generado</h3>
            <div class="mobile-chart-actions">
                <div class="btn-group" role="group">
                    <button class="btn btn-sm btn-outline-secondary" onclick="exportMobileChart('png')" title="Exportar PNG">
                        <i class="fas fa-image"></i>
                    </button>
                    <button class="btn btn-sm btn-outline-secondary" onclick="exportMobileChart('pdf')" title="Exportar PDF">
                        <i class="fas fa-file-pdf"></i>
                    </button>
                    <button class="btn btn-sm btn-outline-secondary" onclick="downloadMobileChart()" title="Descargar datos">
                        <i class="fas fa-download"></i>
                    </button>
                </div>
                <button class="btn btn-sm btn-success ms-2" onclick="showMobileSaveModal()" title="Guardar análisis" id="saveAnalysisBtn">
                    <i class="fas fa-save"></i>
                </button>
            </div>
        </div>
                            <div class="mobile-chart-container" id="mobileChartContainer">
                                <!-- El gráfico se mostrará aquí -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Summary Section Móvil -->
        <section id="summary-section" class="mobile-section">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12">
                        <div class="mobile-card">
                            <h2 class="mobile-card-title">
                                <i class="fas fa-chart-pie me-2"></i>
                                Resumen de Datos
                            </h2>
                            <p class="mobile-card-text">Estadísticas descriptivas de tu dataset</p>
                            
                            <div class="mobile-summary-cards" id="mobileSummaryCards">
                                <!-- Las tarjetas de resumen se generarán aquí -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer Móvil -->
    <footer class="mobile-footer">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mobile-footer-text">
                        © 2024 ASAPALSA Analytics - Versión Móvil
                    </p>
                    <p class="mobile-footer-text">
                        Desarrollado por Leonel Villanueva y Arnold Suate
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Loading Modal Móvil -->
    <div class="modal fade" id="mobileLoadingModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content mobile-modal">
                <div class="modal-body text-center">
                    <div class="mobile-spinner">
                        <i class="fas fa-spinner fa-spin"></i>
                    </div>
                    <h5 class="mobile-modal-title">Procesando datos...</h5>
                    <p class="mobile-modal-text">Por favor espera mientras generamos tu análisis</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para guardar análisis -->
    <div class="modal fade" id="mobileSaveAnalysisModal" tabindex="-1" aria-labelledby="mobileSaveAnalysisModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content mobile-modal">
                <div class="modal-header">
                    <h5 class="modal-title mobile-modal-title" id="mobileSaveAnalysisModalLabel">
                        <i class="fas fa-save me-2"></i>Guardar Análisis
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="mobileSaveAnalysisForm">
                        <div class="mb-3">
                            <label for="mobileAnalysisName" class="form-label mobile-form-label">
                                <i class="fas fa-tag me-1"></i>Nombre del Análisis
                            </label>
                            <input type="text" class="form-control mobile-form-control" id="mobileAnalysisName" 
                                   placeholder="Ej: Análisis de Proyecciones 2024" required>
                        </div>
                        <div class="mb-3">
                            <label for="mobileAnalysisDescription" class="form-label mobile-form-label">
                                <i class="fas fa-align-left me-1"></i>Descripción (opcional)
                            </label>
                            <textarea class="form-control mobile-form-control" id="mobileAnalysisDescription" 
                                      rows="3" placeholder="Descripción del análisis..."></textarea>
                        </div>
                        <div class="alert alert-info mobile-alert">
                            <i class="fas fa-info-circle me-2"></i>
                            <small>Este análisis se guardará en tu historial y podrás acceder a él desde la sección principal.</small>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-1"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-success" id="mobileConfirmSaveAnalysis">
                        <i class="fas fa-save me-1"></i>Guardar Análisis
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="{{ url_for('static', filename='js/mobile.js') }}"></script>
</body>
</html>
